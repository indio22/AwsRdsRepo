<html>

<head>
</head>

<body>
    <h1>Transmission Interface</h1>
    <div id="entries">
        <h2>Temp entry in the entries div.</h2>
    </div>

    <h1>Enter new transmission name:</h1>
    <form>
        <label for="msg">Enter new transmission name here:</label>
        <textarea id="msg"></textarea>

        <button id='submitButton'>Submit</button>
    </form>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script type="text/javascript">
        var API_URL = 'https://vk1nvolbo6.execute-api.us-east-1.amazonaws.com/dev/transmission';

        //Next line basically says "when the document is ready".
        $(document).ready(function () {
            //This is going to do an ajax request, posting to the lambda endpoint.
            $.ajax({
                type: 'GET',
                url: API_URL,

                //Looks like if the post was success, the data returned is passed into this function.
                success: function(data) {
                    //This clears out the entries div further up.
                    $('#entries').html('');

                    //Loops through the returned data items, displays in the "entries" division.
                    data.Items.forEach(function (transmissionItem) {
                        $('#entries').append('<p>' + transmissionItem.message + '</p>');
                    })
                }
            });
        });

        $('#submitButton').on ('click', function () {
            //This is going to do an ajax request, posting to the lambda endpoint.
            $.ajax({
                type: 'POST',
                url: API_URL,
                data: JSON.stringify({"message": $('#msg').val()}),
                contentType: "application/json",

                //Looks like if the post was success, the data returned is passed into this function.
                success: function (data) {
                    //This clears out the entries div further up.
                    location.reload();
                }
            });

            //Without this page might refresh before page ajax can complete.
            return false;
        });
    </script>

</body>

</html>